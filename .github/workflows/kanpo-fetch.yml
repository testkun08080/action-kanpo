name: 毎日官報発行チェッカー

on:
  schedule:
    - cron: "45 23 * * *" # 毎日8:45 JST
  workflow_dispatch:

jobs:
  # test:
  #   name: 発行チェックテスト
  #   runs-on: ubuntu-latest
  #   outputs:
  #     test-result: ${{ steps.test.outcome }}
  #   steps:
  #     - uses: actions/checkout@v4

  #     - name: Pythonセットアップ
  #       uses: actions/setup-python@v4
  #       with:
  #         python-version: "3.11"

  #     - name: 依存関係インストール
  #       run: pip install requests beautifulsoup4 python-dateutil beautifulsoup4

  #     - name: テスト実行
  #       id: test
  #       run: python scripts/fetch_kanpo.py --test

  fetch-kanpo:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: 官報スクレイピング（Docker Action）
        uses: testkun08080/action-kanpo@main
        with:
          dlpdf: "true"
          date: "2025-07-03"

  # fetch:
  #   name: 官報スクレイピング実行
  #   runs-on: ubuntu-latest
  #   needs: test
  #   if: success() # testジョブが成功したらのみ実行
  #   steps:
  #     - uses: actions/checkout@v4

  #     - name: Pythonセットアップ
  #       uses: actions/setup-python@v4
  #       with:
  #         python-version: "3.11"

  #     - name: 依存関係インストール
  #       run: pip install requests beautifulsoup4 python-dateutil

  #     - name: 官報本番スクレイピング
  #       run: python scripts/fetch_kanpo.py

  # commit:
  #   name: 変更をコミット
  #   runs-on: ubuntu-latest
  #   needs: fetch
  #   if: success()
  #   steps:
  #     - uses: actions/checkout@v4

  #     - name: Git 設定とコミット
  #       run: |
  #         git config --local user.email "action@github.com"
  #         git config --local user.name "GitHub Action"
  #         git add .
  #         if git diff --staged --quiet; then
  #           echo "📭 変更なし（新しい官報はありません）"
  #         else
  #           git commit -m "官報更新: $(date '+%Y-%m-%d')"
  #           git push

  #           name: Send a Tweet

  # tweet:
  #   name: ツイート送信
  #   needs: test
  #   if: success()
  #   runs-on: ubuntu-latest
  #   steps:
  #     - uses: noweh/post-tweet-v2-action@v1.0
  #       with:
  #         message: "今日の官報！最新の官報をチェックしてください。 #官報"
  #         consumer-key: ${{ secrets.TWITTER_CONSUMER_KEY }}
  #         consumer-secret: ${{ secrets.TWITTER_CONSUMER_SECRET }}
  #         access-token: ${{ secrets.TWITTER_ACCESS_TOKEN }}
  #         access-token-secret: ${{ secrets.TWITTER_ACCESS_TOKEN_SECRET }}
